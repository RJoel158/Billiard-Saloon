# ğŸ¨ Diagramas Visuales - Sistema de Registro

## Arquitectura General

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND (React)                             â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Register Component                                         â”‚   â”‚
â”‚  â”‚  - first_name                                              â”‚   â”‚
â”‚  â”‚  - last_name                                               â”‚   â”‚
â”‚  â”‚  - email                                                   â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  POST /api/auth/register â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                          â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                           â”‚ HTTP
                                                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND (Express.js)                              â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Routes (auth.routes.js)                                   â”‚  â”‚
â”‚  â”‚  GET/POST handlers                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                           â”‚                                          â”‚
â”‚                           â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Controller (auth.controller.js)                            â”‚  â”‚
â”‚  â”‚  - Validaciones                                             â”‚  â”‚
â”‚  â”‚  - GeneraciÃ³n de contraseÃ±a                                 â”‚  â”‚
â”‚  â”‚  - Manejo de errores                                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”˜  â”‚
â”‚                   â”‚                                           â”‚     â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚     â”‚
â”‚         â”‚                                                     â”‚     â”‚
â”‚         â–¼                                                     â–¼     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Service             â”‚                      â”‚ Service          â”‚â”‚
â”‚  â”‚ (user.service.js)   â”‚                      â”‚ (email.service.jsâ”‚â”‚
â”‚  â”‚                     â”‚                      â”‚                  â”‚â”‚
â”‚  â”‚ â€¢ LÃ³gica negocio    â”‚                      â”‚ â€¢ EnvÃ­o email    â”‚â”‚
â”‚  â”‚ â€¢ Validaciones      â”‚                      â”‚ â€¢ Plantillas     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚ â€¢ Nodemailer     â”‚â”‚
â”‚             â”‚                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚             â–¼                                          â”‚           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚           â”‚
â”‚  â”‚ Repository          â”‚                            â”‚           â”‚
â”‚  â”‚ (user.repository.js)â”‚                            â”‚           â”‚
â”‚  â”‚                     â”‚                            â”‚           â”‚
â”‚  â”‚ â€¢ INSERT, SELECT    â”‚                            â”‚           â”‚
â”‚  â”‚ â€¢ UPDATE, DELETE    â”‚                            â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚           â”‚
â”‚             â”‚                                        â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                                        â”‚
              â”‚ SQL                                    â”‚ SMTP
              â–¼                                        â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ MySQL Database  â”‚                    â”‚ Gmail Server     â”‚
      â”‚ (BD local)      â”‚                    â”‚ (smtp.gmail.com) â”‚
      â”‚ users table     â”‚                    â”‚                  â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Flujo Detallado del Registro

```
1. USUARIO LLENA FORMULARIO
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Nombre: Juan                     â”‚
   â”‚ Apellido: PÃ©rez                  â”‚
   â”‚ Email: juan@gmail.com            â”‚
   â”‚                                  â”‚
   â”‚ [Registrarse]                    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼ POST /api/auth/register

2. BACKEND RECIBE SOLICITUD
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ req.body = {                     â”‚
   â”‚   first_name: "Juan",            â”‚
   â”‚   last_name: "PÃ©rez",            â”‚
   â”‚   email: "juan@gmail.com"        â”‚
   â”‚ }                                â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼ VALIDACIONES

3. VALIDAR CAMPOS REQUERIDOS
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ âœ… first_name presente?          â”‚
   â”‚ âœ… last_name presente?           â”‚
   â”‚ âœ… email presente?               â”‚
   â”‚                                  â”‚
   â”‚ âŒ No â†’ Error 400                â”‚
   â”‚ âœ… SÃ­ â†’ Continuar                â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼ VALIDAR EMAIL

4. VALIDAR FORMATO DE EMAIL
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Regex: /^[^\s@]+@[^\s@]+\.[^\s@]â”‚
   â”‚                                  â”‚
   â”‚ juan@gmail.com âœ…                â”‚
   â”‚ juangmail.com âŒ                 â”‚
   â”‚ juan@.com âŒ                     â”‚
   â”‚                                  â”‚
   â”‚ âŒ Formato invÃ¡lido â†’ Error 400  â”‚
   â”‚ âœ… Formato vÃ¡lido â†’ Continuar    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼ VERIFICAR UNIQUENESS

5. VERIFICAR QUE EMAIL NO EXISTA
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ SELECT * FROM users              â”‚
   â”‚ WHERE email = 'juan@gmail.com'   â”‚
   â”‚                                  â”‚
   â”‚ âŒ Existe â†’ Error 409            â”‚
   â”‚ âœ… No existe â†’ Continuar         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼ GENERAR PASSWORD

6. GENERAR CONTRASEÃ‘A TEMPORAL
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ function generateTemp() {        â”‚
   â”‚   let pwd = ''                   â”‚
   â”‚   for (i = 0; i < 12; i++) {    â”‚
   â”‚     pwd += chars[random(0,50)]  â”‚
   â”‚   }                              â”‚
   â”‚   return pwd                     â”‚
   â”‚ }                                â”‚
   â”‚                                  â”‚
   â”‚ Resultado: K@5mL9pQx2Rt         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼ HASH PASSWORD

7. HASHEAR CON BCRYPT
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ const hashed =                   â”‚
   â”‚   await bcrypt.hash(tempPass, 10)â”‚
   â”‚                                  â”‚
   â”‚ K@5mL9pQx2Rt                    â”‚
   â”‚              â†“ hash              â”‚
   â”‚ $2b$10$mKn...xyz               â”‚
   â”‚                                  â”‚
   â”‚ â€¢ Irreversible                   â”‚
   â”‚ â€¢ Con salt                       â”‚
   â”‚ â€¢ 2^10 iteraciones               â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼ CREAR EN BD

8. INSERTAR USUARIO EN BD
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ INSERT INTO users VALUES         â”‚
   â”‚ (NULL,                           â”‚
   â”‚  2,                    [role_id] â”‚
   â”‚  'Juan',               [first_n] â”‚
   â”‚  'PÃ©rez',              [last_n]  â”‚
   â”‚  'juan@gmail.com',     [email]   â”‚
   â”‚  '$2b$10$mKn...xyz',   [pwd_h]   â”‚
   â”‚  NULL,                 [phone]   â”‚
   â”‚  '2025-12-02...',      [created] â”‚
   â”‚  1)                    [status]  â”‚
   â”‚                                  â”‚
   â”‚ user_id = 123 â† AUTO_INCREMENT   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼ ENVIAR EMAIL

9. ENVIAR EMAIL DE BIENVENIDA
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ await emailService.sendWelcome(  â”‚
   â”‚   'Juan',                        â”‚
   â”‚   'juan@gmail.com',              â”‚
   â”‚   'K@5mL9pQx2Rt'                â”‚
   â”‚ )                                â”‚
   â”‚                                  â”‚
   â”‚ Nodemailer â†’ Gmail SMTP          â”‚
   â”‚ â†’ Bandeja de juan@gmail.com      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼ RESPONDER AL CLIENTE

10. RESPUESTA 201 CREATED
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ {                                â”‚
    â”‚   "success": true,               â”‚
    â”‚   "message": "Usuario registrado â”‚
    â”‚              exitosamente...",   â”‚
    â”‚   "data": {                      â”‚
    â”‚     "id": 123,                   â”‚
    â”‚     "role_id": 2,                â”‚
    â”‚     "first_name": "Juan",        â”‚
    â”‚     "last_name": "PÃ©rez",        â”‚
    â”‚     "email": "juan@gmail.com",   â”‚
    â”‚     "status": 1                  â”‚
    â”‚   }                              â”‚
    â”‚ }                                â”‚
    â”‚                                  â”‚
    â”‚ âš ï¸ Nota: password_hash NO se     â”‚
    â”‚ incluye por seguridad            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼ USUARIO RECIBE EMAIL

11. EMAIL RECIBIDO
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”‚
    â”‚ â•‘    ğŸ± BILLIARD SALOON      â•‘   â”‚
    â”‚ â•‘  Â¡Bienvenido a nuestro    â•‘   â”‚
    â”‚ â•‘  sistema!                  â•‘   â”‚
    â”‚ â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
    â”‚                                  â”‚
    â”‚ Â¡Hola Juan!                      â”‚
    â”‚                                  â”‚
    â”‚ Tu cuenta ha sido creada.        â”‚
    â”‚                                  â”‚
    â”‚ Email: juan@gmail.com            â”‚
    â”‚ ContraseÃ±a: K@5mL9pQx2Rt        â”‚
    â”‚                                  â”‚
    â”‚ âš ï¸ Cambia tu contraseÃ±a en el   â”‚
    â”‚ primer login                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼ USUARIO INICIA SESIÃ“N

12. LOGIN CON TEMP PASSWORD
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Email: juan@gmail.com            â”‚
    â”‚ ContraseÃ±a: K@5mL9pQx2Rt        â”‚
    â”‚                                  â”‚
    â”‚ [Iniciar SesiÃ³n]                 â”‚
    â”‚                                  â”‚
    â”‚ âœ… AutenticaciÃ³n exitosa         â”‚
    â”‚ âœ… Genera JWT token              â”‚
    â”‚ âœ… Usuario puede acceder         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Estructura de Carpetas

```
Server/
â”‚
â”œâ”€â”€ index.js
â”‚   â””â”€ Punto de entrada
â”‚   â””â”€ Monta todas las rutas
â”‚   â””â”€ Inicializa servidor
â”‚
â”œâ”€â”€ package.json
â”‚   â””â”€ Incluye: nodemailer, bcrypt, express, mysql2
â”‚
â”œâ”€â”€ .env
â”‚   â””â”€ GMAIL_USER=tu_email@gmail.com
â”‚   â””â”€ GMAIL_PASSWORD=contraseÃ±a_app
â”‚   â””â”€ DB_HOST, DB_USER, etc.
â”‚
â”œâ”€â”€ src/
â”‚   â”‚
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€ index.js (configuraciones)
â”‚   â”‚
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”œâ”€ db.js (conexiÃ³n BD)
â”‚   â”‚   â””â”€ schema.js
â”‚   â”‚
â”‚   â”œâ”€â”€ middlewares/
â”‚   â”‚   â”œâ”€ apiError.js (clase de errores)
â”‚   â”‚   â””â”€ errorHandler.js (middleware)
â”‚   â”‚
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€ auth.routes.js          âœ¨ NUEVO
â”‚   â”‚   â”œâ”€ user.routes.js
â”‚   â”‚   â”œâ”€ payment.routes.js
â”‚   â”‚   â””â”€ ... (mÃ¡s rutas)
â”‚   â”‚
â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”œâ”€ auth.controller.js      âœ¨ NUEVO
â”‚   â”‚   â”œâ”€ user.controller.js
â”‚   â”‚   â”œâ”€ payment.controller.js
â”‚   â”‚   â””â”€ ... (mÃ¡s controllers)
â”‚   â”‚
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€ email.service.js        âœ¨ NUEVO
â”‚   â”‚   â”œâ”€ user.service.js         ğŸ”„ ACTUALIZADO
â”‚   â”‚   â”œâ”€ payment.service.js
â”‚   â”‚   â””â”€ ... (mÃ¡s services)
â”‚   â”‚
â”‚   â””â”€ repositories/
â”‚       â”œâ”€ user.repository.js
â”‚       â”œâ”€ payment.repository.js
â”‚       â””â”€ ... (mÃ¡s repos)
â”‚
â””â”€â”€ api_tests_auth.http
    â””â”€ 25 ejemplos de pruebas
```

---

## Seguridad - Capas

```
                         USUARIO
                            â”‚
                            â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      Capa 1  â”‚ VALIDACIÃ“N FRONTEND      â”‚
              â”‚ â€¢ Email vÃ¡lido           â”‚
              â”‚ â€¢ Campos no vacÃ­os       â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼ HTTP POST
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      Capa 2  â”‚ VALIDACIÃ“N BACKEND       â”‚
              â”‚ â€¢ Email vÃ¡lido (regex)   â”‚
              â”‚ â€¢ Campos requeridos      â”‚
              â”‚ â€¢ Email Ãºnico (SELECT)   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      Capa 3  â”‚ GENERACIÃ“N SEGURA        â”‚
              â”‚ â€¢ 12 caracteres aleatorios
              â”‚ â€¢ MÃºltiples tipos        â”‚
              â”‚ â€¢ No predecible          â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      Capa 4  â”‚ HASHING                  â”‚
              â”‚ â€¢ Bcrypt con salt        â”‚
              â”‚ â€¢ 2^10 iteraciones       â”‚
              â”‚ â€¢ Irreversible           â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      Capa 5  â”‚ ALMACENAMIENTO SEGURO    â”‚
              â”‚ â€¢ Hash en BD (no password)
              â”‚ â€¢ Encrypted .env (CI/CD) â”‚
              â”‚ â€¢ .gitignore (.env)      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      Capa 6  â”‚ EMAIL SEGURO             â”‚
              â”‚ â€¢ HTTPS en producciÃ³n    â”‚
              â”‚ â€¢ Credenciales de app    â”‚
              â”‚ â€¢ HTML escapado          â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                    USUARIO SEGURO âœ…
```

---

## Manejo de Errores

```
Error Posible                    Status   ErrorCode
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Campos faltantes               400      MISSING_FIELDS
Email invÃ¡lido                 400      INVALID_EMAIL
ContraseÃ±a dÃ©bil               400      WEAK_PASSWORD
Passwords no coinciden         400      PASSWORDS_MISMATCH

Email ya existe                409      EMAIL_EXISTS

Error interno del servidor     500      INTERNAL_ERROR
Error al enviar email          500      EMAIL_SEND_ERROR
Error de base de datos         500      DATABASE_ERROR

                â–¼

        Middleware errorHandler
                â–¼
        
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ {                               â”‚
â”‚   "success": false,             â”‚
â”‚   "error": "EMAIL_EXISTS",      â”‚
â”‚   "message": "Email registrado" â”‚
â”‚ }                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â–¼
        Respuesta al cliente
```

---

## ComparaciÃ³n de MÃ©todos de AutenticaciÃ³n

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MÃ©todo      â”‚ Seguridad  â”‚ Inicio   â”‚ RecomendaciÃ³n
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Text plano  â”‚ âŒ PÃ©sima  â”‚ âš¡ RÃ¡pido â”‚ âŒ NUNCA
â”‚             â”‚            â”‚          â”‚
â”‚ MD5/SHA1    â”‚ âŒ DÃ©bil   â”‚ âš¡ RÃ¡pido â”‚ âŒ NO
â”‚             â”‚            â”‚          â”‚
â”‚ Bcrypt      â”‚ âœ… Buena   â”‚ ğŸ¢ Lento â”‚ âœ… SÃ
â”‚             â”‚            â”‚          â”‚
â”‚ Argon2      â”‚ âœ…âœ… Excelenteâ”‚ ğŸ¢ Lentoâ”‚ âœ… MÃS SEGURO
â”‚             â”‚            â”‚          â”‚
â”‚ PBKDF2      â”‚ âœ… Buena   â”‚ ğŸ¢ Lento â”‚ âœ… Alternativa
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

TU PROYECTO USA: Bcrypt âœ… (Excelente elecciÃ³n)
```

---

## Timeline de Desarrollo

```
Semana 1:
  DÃ­a 1-2: Entender estructura MSC
  DÃ­a 3: Crear email.service.js
  DÃ­a 4: Crear auth.controller.js
  DÃ­a 5: Crear auth.routes.js
  
Semana 2:
  DÃ­a 1: Configurar Gmail + .env
  DÃ­a 2-3: Pruebas (Thunder Client)
  DÃ­a 4: Integrar con Frontend (React)
  DÃ­a 5: DocumentaciÃ³n completa

Resultado:
  âœ… Sistema funcional
  âœ… DocumentaciÃ³n extensa
  âœ… Listo para defensa
  âœ… CÃ³digo producciÃ³n-ready
```

---

## Resumen Visual

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ  SISTEMA DE REGISTRO CON EMAIL            â”ƒ
â”£â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”«
â”ƒ                                            â”ƒ
â”ƒ  Frontend (React)                          â”ƒ
â”ƒ      â”‚                                     â”ƒ
â”ƒ      â”œâ”€â†’ POST /api/auth/register          â”ƒ
â”ƒ      â”‚   â”œâ”€ first_name                    â”ƒ
â”ƒ      â”‚   â”œâ”€ last_name                     â”ƒ
â”ƒ      â”‚   â””â”€ email                         â”ƒ
â”ƒ      â”‚                                     â”ƒ
â”ƒ  Backend (Express)                        â”ƒ
â”ƒ      â”œâ”€ ValidaciÃ³n â†’ Routes               â”ƒ
â”ƒ      â”œâ”€ LÃ³gica â†’ Controllers              â”ƒ
â”ƒ      â”œâ”€ Negocio â†’ Services                â”ƒ
â”ƒ      â””â”€ Datos â†’ Repositories â†’ MySQL      â”ƒ
â”ƒ                                            â”ƒ
â”ƒ  Email (Nodemailer)                       â”ƒ
â”ƒ      â”œâ”€ SMTP: smtp.gmail.com              â”ƒ
â”ƒ      â”œâ”€ Credenciales: .env                â”ƒ
â”ƒ      â””â”€ EnvÃ­o: async/await                â”ƒ
â”ƒ                                            â”ƒ
â”ƒ  Seguridad                                 â”ƒ
â”ƒ      â”œâ”€ Bcrypt (password hashing)         â”ƒ
â”ƒ      â”œâ”€ ValidaciÃ³n (regex, uniqueness)    â”ƒ
â”ƒ      â”œâ”€ .env (credenciales)               â”ƒ
â”ƒ      â””â”€ Error handling (consistente)      â”ƒ
â”ƒ                                            â”ƒ
â”ƒ  DocumentaciÃ³n                             â”ƒ
â”ƒ      â”œâ”€ GuÃ­a paso a paso                  â”ƒ
â”ƒ      â”œâ”€ Preguntas defensa                 â”ƒ
â”ƒ      â”œâ”€ Ejemplos HTTP                     â”ƒ
â”ƒ      â””â”€ Diagramas visuales                â”ƒ
â”ƒ                                            â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
```

